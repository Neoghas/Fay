<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Faylotto Spin Wheel</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<style>
  body {
    background: radial-gradient(circle at center, #111, #000);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    overflow: hidden;
    font-family: "Poppins", sans-serif;
  }

  .wheel-container {
    position: relative;
    width: 350px;
    height: 350px;
  }

  canvas {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    transform-origin: center;
  }

  /* Pointer di posisi jam 12 */
  .pointer {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-bottom: 30px solid red;
    z-index: 10;
    filter: drop-shadow(0 0 6px #f00);
  }

  #spinBtn {
    margin-top: 50px;
    background: gold;
    border: none;
    padding: 18px 45px;
    border-radius: 50px;
    color: black;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 0 20px gold;
    transition: transform 0.1s ease;
  }
  #spinBtn:active {
    transform: scale(0.95);
  }

  #result {
    margin-top: 25px;
    font-size: 18px;
    color: gold;
    text-align: center;
  }
</style>
</head>
<body>
  <div class="wheel-container">
    <canvas id="wheel" width="350" height="350"></canvas>
    <div class="pointer"></div>
  </div>
  <button id="spinBtn">SPIN</button>
  <div id="result">🎯 Ready to spin!</div>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const btn = document.getElementById("spinBtn");
const resultText = document.getElementById("result");

const prizes = [
  { text: "MacBook", color: "#FFB703", emoji: "💻" },
  { text: "iPhone", color: "#8ECAE6", emoji: "📱" },
  { text: "0.1 ETH", color: "#FB8500", emoji: "🪙" },
  { text: "0.05 ETH", color: "#90EE90", emoji: "💰" },
  { text: "0.005 ETH", color: "#FFD700", emoji: "🤑" },
  { text: "1 LPoint", color: "#9370DB", emoji: "⭐" },
  { text: "2 LPoint", color: "#FF69B4", emoji: "🎯" },
  { text: "Big Win", color: "#20B2AA", emoji: "🏆" }
];

const slices = prizes.length;
const sliceAngle = 360 / slices;
let rotation = 0;
let spinning = false;

// 🎨 Gambar roda
function drawWheel() {
  const radius = canvas.width / 2;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  for (let i = 0; i < slices; i++) {
    const start = (sliceAngle * i) * Math.PI / 180;
    const end = (sliceAngle * (i + 1)) * Math.PI / 180;

    // sektor warna
    ctx.beginPath();
    ctx.moveTo(radius, radius);
    ctx.arc(radius, radius, radius, start, end);
    ctx.fillStyle = prizes[i].color;
    ctx.fill();
    ctx.strokeStyle = "#111";
    ctx.stroke();

    // teks & emoji
    ctx.save();
    ctx.translate(radius, radius);
    ctx.rotate((start + end) / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#000";
    ctx.font = "bold 14px Poppins";
    ctx.fillText(prizes[i].emoji + " " + prizes[i].text, radius - 10, 5);
    ctx.restore();
  }
}
drawWheel();

btn.addEventListener("click", () => {
  if (spinning) return;
  spinning = true;

  const randomIndex = Math.floor(Math.random() * prizes.length);
  const stopAngle = 360 * 8 + (360 - (randomIndex * sliceAngle + sliceAngle / 2));

  gsap.to(".wheel-container canvas", {
    rotation: stopAngle,
    duration: 8,
    ease: "power4.out",
    transformOrigin: "50% 50%",
    onComplete: () => {
      spinning = false;
      const prize = prizes[randomIndex];
      resultText.innerHTML = `🎉 You won: <b>${prize.text}</b> ${prize.emoji}`;
      // simpan rotasi akhir supaya spin berikutnya tetap sinkron
      rotation = stopAngle % 360;
      gsap.set(".wheel-container canvas", { rotation });
    }
  });
});
</script>
</body>
</html>
