<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bambang Pass Royale â€” Minimal Game UI</title>
<style>
  :root{
    --bg:#08101a;
    --panel:#0b1724;
    --muted:#93a6bd;
    --accent:#5eead4; /* teal */
    --accent2:#7c3aed; /* purple */
    --danger:#ff6b6b;
    --card-bg: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; min-height:100%; background:
      radial-gradient(600px 200px at 10% 10%, rgba(124,58,237,0.04), transparent),
      linear-gradient(180deg,var(--bg),#03101a 80%); color:#e6eef8;
    font-family: Inter, system-ui, -apple-system, "Helvetica Neue", Arial; -webkit-font-smoothing:antialiased;
    padding:18px;
  }

  .app{max-width:1100px;margin:0 auto; display:grid; grid-template-columns: 1fr 360px; gap:18px; align-items:start;}
  @media (max-width:980px){ .app{grid-template-columns:1fr; padding-bottom:60px} .right-col{order:2} }

  /* LEFT: arena + header */
  .stage{background:var(--card-bg); border-radius:14px; padding:18px; box-shadow:0 8px 30px rgba(2,6,23,0.6); position:relative}
  .header-row{display:flex; align-items:center; gap:12px; margin-bottom:12px}
  .title{font-weight:800; font-size:20px; letter-spacing:0.2px}
  .sub{color:var(--muted); font-size:13px}
  .big-cta{margin-left:auto; display:flex; gap:10px; align-items:center}
  .btn{background:linear-gradient(90deg,var(--accent2),#4f46e5); color:#03101a; padding:10px 14px; border-radius:12px; font-weight:700; border:none; cursor:pointer; box-shadow:0 8px 30px rgba(76,29,149,0.15)}
  .ghost{background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); padding:8px 10px; border-radius:10px}

  /* arena */
  .arena-wrap{display:flex; gap:18px; align-items:stretch}
  .arena{
    flex:1; min-height:420px; background: radial-gradient(circle at 50% 20%, rgba(124,58,237,0.03), transparent 30%), linear-gradient(180deg,#041022,#02111b);
    border-radius:12px; display:flex; flex-direction:column; align-items:center; padding:16px; position:relative; overflow:hidden;
  }
  .arena-canvas{position:relative; width:100%; height:320px; display:flex; align-items:center; justify-content:center}
  .ring{width:320px; height:320px; border-radius:999px; position:relative;
       background: radial-gradient(circle at 50% 45%, rgba(255,255,255,0.02), transparent 20%);
       box-shadow: inset 0 0 40px rgba(124,58,237,0.03);}
  .avatar{
    width:66px; height:66px; border-radius:999px; display:flex; align-items:center; justify-content:center; flex-direction:column;
    font-weight:800; font-size:12px; position:absolute; transition:transform .3s ease, box-shadow .3s ease, opacity .45s ease;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border: 2px solid rgba(255,255,255,0.03);
    color:#fff;
  }
  .avatar .icon{ font-size:22px; margin-bottom:2px}
  .avatar.bomb{ box-shadow: 0 14px 40px rgba(255,83,83,0.16); transform:scale(1.06); border-color: rgba(255,110,110,0.8) }
  .avatar.elim{ opacity:.22; transform:scale(.9) rotate(-8deg) }
  /* countdown ring inside avatar */
  .count-ring{ position:absolute; width:76px; height:76px; border-radius:999px; left:-5px; top:-5px; pointer-events:none; display:none }
  .count-ring svg { width:100%; height:100%; transform:rotate(-90deg) }

  /* center bomb */
  .bomb-center{ position:absolute; width:86px; height:86px; border-radius:999px; background: linear-gradient(180deg,#ffbfbf,#ff7777); display:flex; align-items:center; justify-content:center; color:#2a0a0a; font-weight:900; font-size:26px; box-shadow:0 18px 50px rgba(255,90,90,0.18) }
  .hud{margin-top:12px; display:flex; gap:12px; width:100%; align-items:center}
  .hud .panel{flex:1; background:rgba(255,255,255,0.02); padding:10px; border-radius:10px; text-align:center}
  .hud .panel .num{font-weight:800; font-size:20px}
  .log{ margin-top:12px; font-size:13px; color:var(--muted); max-height:86px; overflow:auto; padding:8px; border-radius:8px; background:rgba(255,255,255,0.01) }

  /* RIGHT: selector cards minimal like screenshot */
  .right-col{display:flex; flex-direction:column; gap:12px}
  .card-grid{ display:grid; grid-template-columns: repeat(2,1fr); gap:10px }
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:12px; padding:12px; position:relative;
    border:2px solid rgba(255,255,255,0.03); cursor:pointer; transition:transform .18s ease, box-shadow .18s ease;
  }
  .card:hover{ transform:translateY(-6px); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
  .card.selected{ border-color: var(--accent); box-shadow: 0 8px 30px rgba(94,234,212,0.06); }
  .card .emoji{font-size:28px; margin-bottom:8px}
  .card .name{font-weight:800}
  .card .meta{font-size:12px;color:var(--muted); margin-top:6px}

  /* footer small controls */
  .controls-ctas{ display:flex; gap:8px; margin-top:10px}
  .mini{padding:8px 10px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03); color:var(--muted)}
  /* podium */
  .podium{ position:absolute; left:50%; transform:translateX(-50%); bottom:12px; display:flex; gap:12px; pointer-events:none }
  .podium .slot{ width:74px; height:62px; border-radius:8px; background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(255,255,255,0.01)); color:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center; font-weight:800; font-size:13px; opacity:0; transform:translateY(20px) }
  .podium.show .slot{ opacity:1; transform:translateY(0); transition:all .6s cubic-bezier(.2,.9,.3,1) }

  /* small mobile adjustments */
  @media (max-width:520px){
    .avatar{ width:56px; height:56px; font-size:11px }
    .ring{ width:260px; height:260px }
    .arena-canvas{ height:260px }
    .card-grid{ grid-template-columns: repeat(3,1fr) }
  }

</style>
</head>
<body>

<div class="app">
  <!-- LEFT: Arena -->
  <div class="stage">
    <div class="header-row">
      <div>
        <div class="title">Bambang Pass Royale</div>
        <div class="sub">Minimal game-feel UI â€” 1 bomb, last 3 winners</div>
      </div>
      <div class="big-cta">
        <button class="btn" id="autoFill">Auto-Fill</button>
        <button class="btn" id="startBtn">Start</button>
        <button class="ghost" id="stopBtn" style="display:none">Stop</button>
      </div>
    </div>

    <div class="arena-wrap">
      <div class="arena">
        <div class="arena-canvas">
          <div class="ring" id="ring"></div>
          <!-- avatars injected here -->
          <div class="bomb-center" id="bombCenter" style="display:none">ðŸ’£</div>
        </div>

        <div class="hud">
          <div class="panel">
            <div class="sub">Players</div>
            <div class="num" id="count">0</div>
          </div>
          <div class="panel">
            <div class="sub">Total Pot</div>
            <div class="num" id="pot">0 USDT</div>
          </div>
          <div class="panel">
            <div class="sub">Holder</div>
            <div class="num" id="holderName">-</div>
          </div>
        </div>

        <div class="log" id="log">Event log...</div>

        <div class="podium" id="podium">
          <div class="slot" id="p2" style="transform:translateY(6px);">2</div>
          <div class="slot" id="p1" style="width:90px;height:76px;font-size:15px;background:linear-gradient(90deg,#ffd86b,#ffb86b);color:#111">1</div>
          <div class="slot" id="p3" style="transform:translateY(6px);">3</div>
        </div>
      </div>
    </div>
  </div>

  <!-- RIGHT: Character selector minimal -->
  <div class="right-col">
    <div style="background:var(--card-bg); padding:14px; border-radius:12px; box-shadow:0 8px 30px rgba(2,6,23,0.6)">
      <div style="display:flex;justify-content:space-between; align-items:center;">
        <div>
          <div style="font-weight:800">SELECT CHARACTER</div>
          <div class="sub" style="margin-top:6px">Click to toggle participation</div>
        </div>
        <div style="text-align:right">
          <div class="sub">Ticket</div>
          <select id="ticketPerJoin" style="width:86px;margin-top:6px">
            <option value="1">1</option><option value="2">2</option><option value="3">3</option>
          </select>
        </div>
      </div>

      <div class="card-grid" id="charGrid" style="margin-top:12px">
        <!-- cards injected -->
      </div>

      <div class="controls-ctas" style="margin-top:12px">
        <button class="mini" id="resetBtn">Reset</button>
        <button class="mini" id="fastDemo">Demo Play</button>
      </div>
    </div>

    <div style="background:var(--card-bg); padding:12px; border-radius:12px; margin-top:12px; text-align:center">
      <div style="font-weight:800">PAYOUT (Top 3)</div>
      <div class="sub" style="margin-top:6px">70% / 20% / 10%</div>
      <div style="margin-top:10px"><button class="mini" id="rulesBtn">Rules</button></div>
    </div>
  </div>
</div>

<script>
/* Minimal game-feel Bambang Pass Royale
   - Improved minimal UI styled after provided screenshot vibe
   - Avatars arranged in ring, bomb passes randomly, explosion eliminates holder
   - Stops when <= 3 survivors (podium shows)
   - Auto-fill, demo play, reset
*/

// characters sample (emoji used for simplicity)
const CHAR = [
  { id:'A', name:'TUNA', emoji:'ðŸŸ'},
  { id:'B', name:'CRAB', emoji:'ðŸ¦€'},
  { id:'C', name:'SHARK', emoji:'ðŸ¦ˆ'},
  { id:'D', name:'OCTO', emoji:'ðŸ™'},
  { id:'E', name:'SHRIMP', emoji:'ðŸ¦'},
  { id:'F', name:'ORCA', emoji:'ðŸ‹'},
  { id:'G', name:'RAY', emoji:'ðŸ '},
  { id:'H', name:'SQUID', emoji:'ðŸ¦‘'},
];

let players = []; // {id, name, emoji, tickets, bet, out}
let bombHolder = null;
let running = false;
let passTimer = null, explodeTimer = null, countdownInterval = null;

// ui refs
const ring = document.getElementById('ring'), logEl = document.getElementById('log'), charGrid = document.getElementById('charGrid');
const countEl = document.getElementById('count'), potEl = document.getElementById('pot'), holderEl = document.getElementById('holderName');
const bombCenter = document.getElementById('bombCenter'), podium = document.getElementById('podium');

function uiLog(s){ logEl.innerHTML = `<div style="margin-bottom:6px">${new Date().toLocaleTimeString()} â€¢ ${s}</div>` + logEl.innerHTML; }
function totalPot(){ return players.reduce((s,p)=>s + (p.bet||0), 0); }
function alive(){ return players.filter(p=>!p.out); }

function renderCharGrid(){
  charGrid.innerHTML = '';
  CHAR.forEach(c=>{
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.id = c.id;
    card.innerHTML = `<div class="emoji">${c.emoji}</div><div class="name">${c.name}</div><div class="meta">E:0 U:0 S:0</div>`;
    card.onclick = ()=> {
      toggleJoin(c);
    };
    charGrid.appendChild(card);
  });
}

function toggleJoin(c){
  const joinTicket = parseInt(document.getElementById('ticketPerJoin').value) || 1;
  const found = players.find(p=>p.id === c.id);
  if(found){
    // remove (toggle off)
    players = players.filter(p=>p.id !== c.id);
    uiLog(`${c.name} left`);
  } else {
    players.push({ id:c.id, name:c.name, emoji:c.emoji, tickets:joinTicket, bet: joinTicket, out:false });
    uiLog(`${c.name} joined (x${joinTicket})`);
  }
  renderAll();
}

function renderAll(){
  // avatars in ring
  // clear old avatars
  // remove any children except ring styling
  Array.from(ring.querySelectorAll('.avatar')).forEach(n=>n.remove());
  const slotCount = players.length || 1;
  const radius = Math.min(ring.clientWidth, ring.clientHeight)/2 - 36;
  const cx = ring.clientWidth/2, cy = ring.clientHeight/2;
  players.forEach((p,i)=>{
    const ang = (i/slotCount) * Math.PI*2 - Math.PI/2; // start top
    const x = cx + Math.cos(ang)*radius - 33;
    const y = cy + Math.sin(ang)*radius - 33;
    const el = document.createElement('div');
    el.className = 'avatar' + (p.out ? ' elim' : (bombHolder && bombHolder.id === p.id ? ' bomb' : ''));
    el.id = 'av_'+p.id;
    el.style.left = x + 'px';
    el.style.top = y + 'px';
    el.innerHTML = `<div class="icon">${p.emoji}</div><div style="font-size:10px;margin-top:4px">${p.name}</div>
      <div class="count-ring" id="ring_${p.id}"><svg viewBox="0 0 36 36">
        <path stroke="rgba(255,255,255,0.06)" stroke-width="3" fill="none" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
        <path id="progress_${p.id}" stroke="#ff8b8b" stroke-width="3" stroke-linecap="round" fill="none" stroke-dasharray="100" stroke-dashoffset="100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
      </svg></div>`;
    ring.appendChild(el);
  });
  // update HUD
  countEl.innerText = players.length;
  potEl.innerText = totalPot().toFixed(2) + ' USDT';
  holderEl.innerText = bombHolder ? bombHolder.name : '-';
  // podium hide
  podium.classList.remove('show');
  // show/hide bomb center
  if(bombHolder) bombCenter.style.display = 'block'; else bombCenter.style.display = 'none';
}

// auto-fill
document.getElementById('autoFill').onclick = ()=> {
  players = CHAR.slice(0,8).map((c,i)=>({ id:c.id, name:c.name, emoji:c.emoji, tickets: Math.floor(Math.random()*4)+1, bet: Math.floor(Math.random()*4)+1, out:false }));
  uiLog('Auto-filled players');
  renderAll();
};

// start / stop / reset
document.getElementById('startBtn').onclick = ()=> {
  if(players.length < 4){ alert('Minimal 4 pemain untuk mode 3 winners'); return; }
  if(running) return;
  running = true;
  document.getElementById('startBtn').style.display='none';
  document.getElementById('stopBtn').style.display='inline-block';
  // pick initial holder
  bombHolder = pickWeighted(alive());
  uiLog('Game started. Initial holder: ' + bombHolder.name);
  renderAll();
  passLoop();
  scheduleExplosion();
};
document.getElementById('stopBtn').onclick = ()=> { stopGame(); };
document.getElementById('resetBtn').onclick = ()=> {
  if(running) stopGame();
  players = [];
  bombHolder = null;
  uiLog('Reset');
  renderAll();
};
document.getElementById('fastDemo').onclick = ()=> {
  document.getElementById('autoFill').click();
  setTimeout(()=> document.getElementById('startBtn').click(), 300);
};

// helpers: weighted pick
function pickWeighted(list){
  const pool = [];
  list.forEach(p=>{ for(let i=0;i<p.tickets;i++) pool.push(p); });
  if(pool.length === 0) return list[Math.floor(Math.random()*list.length)];
  return pool[Math.floor(Math.random()*pool.length)];
}
function pickEqual(list){ return list[Math.floor(Math.random()*list.length)]; }

// pass loop
function passLoop(){
  if(!running) return;
  clearTimeout(passTimer);
  const interval = Math.max(200, 550 + Math.random()*260);
  passTimer = setTimeout(()=>{
    // choose next holder excluding current
    const cand = alive().filter(p=>p.id !== bombHolder.id);
    if(cand.length === 0) return;
    const next = pickWeighted(cand);
    bombHolder = next;
    uiLog('Bomb passed to ' + bombHolder.name);
    renderAll();
    passLoop();
  }, interval);
}

// schedule explosion
function scheduleExplosion(){
  clearTimeout(explodeTimer);
  clearInterval(countdownInterval);
  const minT = 1400, maxT = 4000;
  const delay = Math.floor(minT + Math.random()*(maxT - minT));
  const explodeAt = Date.now() + delay;
  // animate circular progress for holder
  const id = bombHolder.id;
  const prog = document.getElementById('progress_'+id);
  if(prog){
    prog.style.transition = `stroke-dashoffset ${delay}ms linear`;
    prog.style.strokeDashoffset = 0;
    // show the ring
    const ringEl = document.getElementById('ring_'+id);
    if(ringEl) ringEl.style.display = 'block';
  }
  // numeric countdown in holder hud
  countdownInterval = setInterval(()=>{
    const remain = Math.max(0, explodeAt - Date.now());
    holderEl.innerText = bombHolder ? bombHolder.name + ' â€¢ ' + (remain/1000).toFixed(2) + 's' : '-';
    if(remain <= 0){ clearInterval(countdownInterval); countdownInterval = null; }
  }, 60);

  explodeTimer = setTimeout(()=> {
    // explode: eliminate current holder if still alive
    const victim = players.find(p=>p.id === bombHolder.id);
    if(victim && !victim.out){
      victim.out = true;
      uiLog(`ðŸ’¥ ${victim.name} exploded and eliminated`);
      // visual: fade avatar
      const el = document.getElementById('av_'+victim.id);
      if(el){ el.classList.add('elim'); }
      // reset holder to random alive
      const survivors = alive();
      if(survivors.length > 0) bombHolder = survivors[Math.floor(Math.random()*survivors.length)];
      else bombHolder = null;
      renderAll();
      // clear progress for victim
      const progV = document.getElementById('progress_'+victim.id); if(progV){ progV.style.transition='none'; progV.style.strokeDashoffset=100; }
    }
    // check end condition
    const remaining = alive();
    if(remaining.length <= 3){
      endGame();
    } else {
      // continue
      passLoop();
      scheduleExplosion();
    }
  }, delay);
}

function stopGame(){
  running = false;
  clearTimeout(passTimer); clearTimeout(explodeTimer); clearInterval(countdownInterval);
  document.getElementById('startBtn').style.display='inline-block';
  document.getElementById('stopBtn').style.display='none';
  uiLog('Game stopped');
}

// end game: show podium and payouts (simple split)
function endGame(){
  running = false;
  clearTimeout(passTimer); clearTimeout(explodeTimer); clearInterval(countdownInterval);
  const surv = alive().slice().sort((a,b)=>b.tickets - a.tickets);
  // simple split: 70/20/10
  const pool = totalPot();
  const s = [0.7,0.2,0.1];
  const payouts = surv.map((p,i)=>({ name:p.name, amount: (pool * (s[i]||0)).toFixed(2) }));
  uiLog('ðŸŽ‰ Game ended. Winners: ' + payouts.map(x=>`${x.name} ${x.amount}`).join(' | '));
  // show podium
  document.getElementById('p1').innerText = payouts[0] ? `${payouts[0].name}` : '-';
  document.getElementById('p2').innerText = payouts[1] ? `${payouts[1].name}` : '-';
  document.getElementById('p3').innerText = payouts[2] ? `${payouts[2].name}` : '-';
  podium.classList.add('show');
  document.getElementById('startBtn').style.display='inline-block';
  document.getElementById('stopBtn').style.display='none';
}

// initial render chars
renderCharGrid();
renderAll();

</script>
</body>
</html>
