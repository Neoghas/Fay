<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Faylotto Spin Battle</title>

<!-- Font & GSAP -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
  body {
    margin: 0;
    height: 100vh;
    background: radial-gradient(circle at center, #0a0a0f 0%, #000 100%);
    font-family: "Orbitron", sans-serif;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  .wheel-container {
    position: relative;
    width: 320px;
    height: 320px;
    border-radius: 50%;
    background: conic-gradient(
      #6200ff 0deg 45deg,
      #00b3ff 45deg 90deg,
      #ff00e6 90deg 135deg,
      #6200ff 135deg 180deg,
      #00b3ff 180deg 225deg,
      #ff00e6 225deg 270deg,
      #6200ff 270deg 315deg,
      #00b3ff 315deg 360deg
    );
    box-shadow: 0 0 40px #6c00ff, inset 0 0 30px #00ffff;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .wheel-hole {
    position: absolute;
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: radial-gradient(circle, #000 60%, #111 100%);
    box-shadow: inset 0 0 25px #6c00ff;
  }

  .controls {
    margin-top: 40px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }

  button {
    background: linear-gradient(90deg, #6200ff, #00b3ff);
    border: none;
    border-radius: 12px;
    color: white;
    font-size: 16px;
    font-weight: bold;
    padding: 12px 28px;
    cursor: pointer;
    text-transform: uppercase;
    box-shadow: 0 0 15px #00b3ff;
    transition: all 0.3s ease;
  }

  button:hover {
    box-shadow: 0 0 25px #ff00e6;
    transform: scale(1.05);
  }

  .status {
    font-size: 14px;
    margin-top: 10px;
    color: #00b3ff;
  }

  .glow {
    position: absolute;
    width: 140%;
    height: 140%;
    top: -20%;
    left: -20%;
    background: radial-gradient(circle, rgba(98,0,255,0.2) 0%, transparent 70%);
    filter: blur(40px);
    z-index: -1;
  }
</style>
</head>

<body>
  <div class="wheel-container" id="wheel">
    <div class="wheel-hole"></div>
    <div class="glow"></div>
  </div>

  <div class="controls">
    <button id="connectBtn">Connect Wallet</button>
    <button id="placeBetBtn">Place Bet</button>
    <button id="disconnectBtn">Disconnect</button>
    <div class="status" id="statusText">Wallet not connected</div>
  </div>

<script>
let provider, signer, userAddress;

// === Connect Wallet ===
async function connectWallet() {
  if (window.ethereum) {
    provider = new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts", []);
    signer = provider.getSigner();
    userAddress = await signer.getAddress();
    document.getElementById("statusText").innerText = "Connected: " + userAddress.slice(0,6) + "..." + userAddress.slice(-4);
  } else {
    alert("MetaMask not found!");
  }
}

// === Disconnect (UI reset only) ===
function disconnectWallet() {
  provider = null;
  signer = null;
  userAddress = null;
  document.getElementById("statusText").innerText = "Wallet not connected";
}

// === Wheel Spin Animation ===
function spinWheel() {
  const wheel = document.getElementById("wheel");
  const angle = 360 * 5 + Math.floor(Math.random() * 360);
  gsap.to(wheel, {
    rotation: angle,
    duration: 5,
    ease: "power4.inOut",
    onComplete: () => {
      gsap.to(wheel, {rotation: angle % 360, duration: 0.5});
      alert("ðŸŽ‰ Spin complete!");
    }
  });
}

// === Place Bet ===
async function placeBet() {
  if (!signer) {
    alert("Connect wallet first!");
    return;
  }

  // nanti ganti address sesuai kontrak kamu
  const contractAddress = "0xYourContractAddressHere";
  const abi = [ "function placeBet() payable" ]; // minimal ABI
  
  const contract = new ethers.Contract(contractAddress, abi, signer);
  try {
    const tx = await contract.placeBet({ value: ethers.utils.parseEther("0.001") });
    document.getElementById("statusText").innerText = "Betting... " + tx.hash.slice(0,10);
    await tx.wait();
    spinWheel();
  } catch (err) {
    console.error(err);
    alert("Transaction failed!");
  }
}

document.getElementById("connectBtn").addEventListener("click", connectWallet);
document.getElementById("disconnectBtn").addEventListener("click", disconnectWallet);
document.getElementById("placeBetBtn").addEventListener("click", placeBet);
</script>
</body>
</html>
