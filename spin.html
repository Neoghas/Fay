<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spin Wheel</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<style>
body {
  background: radial-gradient(circle at center, #111 0%, #000 100%);
  color: white;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  overflow: hidden;
  font-family: 'Poppins', sans-serif;
}

#wheel-container {
  position: relative;
  width: 500px;
  height: 500px;
}

#wheel {
  width: 100%;
  height: 100%;
  transition: filter 0.3s;
}

#pointer {
  position: absolute;
  top: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 50px;
  height: 70px;
  background: red;
  clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
  z-index: 10;
  filter: drop-shadow(0 0 5px #ff0000);
}

#centerBtn {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 120px;
  height: 120px;
  background: gold;
  color: black;
  border-radius: 50%;
  border: none;
  font-weight: bold;
  font-size: 22px;
  cursor: pointer;
  z-index: 5;
  box-shadow: 0 0 15px rgba(255,255,0,0.5);
  transition: all 0.2s;
}
#centerBtn:hover { transform: translate(-50%, -50%) scale(1.05); }

#resultText {
  margin-top: 20px;
  text-align: center;
  font-size: 24px;
}

.glow {
  filter: drop-shadow(0 0 25px gold) brightness(1.4);
}
</style>
</head>
<body>
<div id="wheel-container">
  <div id="pointer"></div>
  <svg id="wheel" viewBox="0 0 500 500"></svg>
  <button id="centerBtn">SPIN</button>
</div>
<div id="resultText"></div>

<!-- Suara -->
<audio id="clickSound" src="click.mp3" preload="auto"></audio>
<audio id="spinSound" src="spin.mp3" preload="auto" loop></audio>
<audio id="winSound" src="win.mp3" preload="auto"></audio>

<script>
const prizes = [
  { name: "1 ETH Jackpot", icon: "icons/eth.png" },
  { name: "0.7 ETH Big Win", icon: "icons/eth.png" },
  { name: "MacBook", icon: "icons/macbook.png" },
  { name: "iPhone or Worth ETH", icon: "icons/iphone.png" },
  { name: "0.1 ETH Monthly Prize", icon: "icons/eth.png" },
  { name: "0.05 ETH Monthly Prize", icon: "icons/eth.png" },
  { name: "0.005 ETH Weekly", icon: "icons/eth.png" },
  { name: "0.0005 ETH 4-Day Prize", icon: "icons/eth.png" },
  { name: "0.0001 ETH Daily Prize", icon: "icons/eth.png" },
  { name: "Won 2 LPoint", icon: "icons/lpoint.png" },
  { name: "Won 5 LPoint", icon: "icons/lpoint.png" },
  { name: "Won 7 LPoint", icon: "icons/lpoint.png" }
];

const colors = [
  "#FFB703","#FB8500","#219EBC","#8ECAE6","#FF69B4","#90EE90",
  "#FFD700","#40E0D0","#ADFF2F","#FF6347","#9370DB","#20B2AA"
];

const svg = document.getElementById("wheel");
const resultText = document.getElementById("resultText");
const btn = document.getElementById("centerBtn");
const clickSound = document.getElementById("clickSound");
const spinSound = document.getElementById("spinSound");
const winSound = document.getElementById("winSound");

const radius = 240;
const cx = 250, cy = 250;
const total = prizes.length;
const slice = 360 / total;

for (let i = 0; i < total; i++) {
  const startAngle = (i * slice - 90) * Math.PI / 180;
  const endAngle = ((i + 1) * slice - 90) * Math.PI / 180;
  const x1 = cx + radius * Math.cos(startAngle);
  const y1 = cy + radius * Math.sin(startAngle);
  const x2 = cx + radius * Math.cos(endAngle);
  const y2 = cy + radius * Math.sin(endAngle);
  const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
  path.setAttribute("d", `M ${cx} ${cy} L ${x1} ${y1} A ${radius} ${radius} 0 0 1 ${x2} ${y2} Z`);
  path.setAttribute("fill", colors[i]);
  path.setAttribute("stroke", "#fff");
  path.setAttribute("stroke-width", "2");
  svg.appendChild(path);
  prizes[i].path = path;

  const angle = (i + 0.5) * slice - 90;
  const img = document.createElementNS("http://www.w3.org/2000/svg", "image");
  const imgX = cx + radius * 0.55 * Math.cos(angle * Math.PI / 180) - 20;
  const imgY = cy + radius * 0.55 * Math.sin(angle * Math.PI / 180) - 20;
  img.setAttributeNS("http://www.w3.org/1999/xlink", "href", prizes[i].icon);
  img.setAttribute("x", imgX);
  img.setAttribute("y", imgY);
  img.setAttribute("width", "40");
  img.setAttribute("height", "40");
  svg.appendChild(img);

  const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
  const textX = cx + radius * 0.8 * Math.cos(angle * Math.PI / 180);
  const textY = cy + radius * 0.8 * Math.sin(angle * Math.PI / 180);
  text.setAttribute("x", textX);
  text.setAttribute("y", textY);
  text.setAttribute("fill", "#000");
  text.setAttribute("font-size", "11");
  text.setAttribute("font-weight", "bold");
  text.setAttribute("text-anchor", "middle");
  text.setAttribute("alignment-baseline", "middle");
  text.setAttribute("transform", `rotate(${angle}, ${textX}, ${textY})`);
  text.textContent = prizes[i].name;
  svg.appendChild(text);
}

let spinning = false;
let currentRotation = 0;
let animation = null;

function getWinningIndex(rotation) {
  const normalized = (360 - (rotation % 360) + 360) % 360;
  return Math.floor(normalized / slice) % total;
}

function resetButton() {
  btn.disabled = false;
  btn.textContent = "SPIN";
}

function spinWheel() {
  if (spinning) return;
  spinning = true;
  clickSound.play();
  btn.disabled = true;
  resultText.textContent = "ðŸŽ¡ Spinning...";
  resultText.style.color = "#00FFFF";
  spinSound.currentTime = 0;
  spinSound.play();

  if (animation) gsap.killTweensOf(svg);
  prizes.forEach(p => p.path.classList.remove("glow"));

  const randomIndex = Math.floor(Math.random() * total);
  const targetSlice = slice * randomIndex + slice / 2;
  const fullRotations = 12;
  const totalRotation = currentRotation + fullRotations * 360 + targetSlice;

  animation = gsap.fromTo(svg, 
    { rotation: currentRotation }, 
    {
      rotation: totalRotation,
      duration: 30,
      ease: "power3.inOut",
      transformOrigin: "center center",
      onUpdate: () => currentRotation = gsap.getProperty(svg, "rotation"),
      onComplete: () => {
        spinSound.pause();
        spinning = false;
        animation = null;
        const winnerIndex = getWinningIndex(currentRotation);
        const prize = prizes[winnerIndex];
        winSound.play();
        prize.path.classList.add("glow");
        resultText.innerHTML = `ðŸŽ‰ You won: <span style="color:gold;font-size:24px;">${prize.name}</span>`;
        setTimeout(resetButton, 2000);
      }
    });
}

btn.addEventListener("click", spinWheel);
</script>
</body>
</html>
